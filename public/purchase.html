<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Complete Purchase - Our Website</title>
  <link rel="stylesheet" href="/css/style.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <!-- Flatpickr (Calendar) CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
</head>
<body>

  <!-- Header -->
  <header class="main-header">
    <div class="container">
      <a href="/" class="logo">WebPro</a>
    </div>
  </header>

  <!-- Main Content -->
  <div id="main-content" style="visibility: visible; opacity: 1;"> <!-- No loader on this page -->
    
    <div class="purchase-flow">
      
      <!-- Step 1: Loading/Checking -->
      <div class="purchase-step active" id="step-loading">
        <div class="spinner"></div>
        <p id="loading-message">Verifying your session...</p>
      </div>

      <!-- Step 2: Schedule -->
      <div class="purchase-step" id="step-schedule">
        <h2>Schedule Your Consultation</h2>
        <p>Please select a date and time for your consultation.</p>
        <div id="calendar-picker" class="form-group"></div>
        <div id="schedule-error"></div>
        <div class="step-nav">
          <button id="btn-to-payment" class="btn btn-primary" disabled>Continue to Payment</button>
        </div>
      </div>

      <!-- Step 3: Payment -->
      <div class="purchase-step" id="step-payment">
        <h2>Complete Your Purchase</h2>
        <div id="payment-summary">
          <p>Package: <span id="summary-package-name">...</span></p>
          <p>Price: <span id="summary-package-price">...</span></p>
          <p>Time: <span id="summary-schedule-time">...</span></p>
        </div>
        <p>Please complete your payment using PayPal.</p>
        <div id="paypal-button-container">
          <!-- PayPal buttons will render here -->
        </div>
        <div id="payment-message"></div>
        <div class="step-nav">
          <button id="btn-back-schedule" class="btn btn-secondary">Back to Schedule</button>
        </div>
      </div>
      
      <!-- Step 4: Thank You -->
      <div class="purchase-step" id="step-thanks">
        <h2>Thank You!</h2>
        <p>Your payment was successful and your consultation is booked.</p>
        <p>A confirmation email has been sent to <strong id="final-user-email">...</strong>.</p>
        <p>Your Order ID is: <strong id="final-order-id">...</strong></p>
        <a href="/dashboard" class="btn btn-primary">Go to Dashboard</a>
      </div>

    </div>

  </div>

  <!-- Footer -->
  <footer class="main-footer">
    <div class="container">
      <p>&copy; 2025 WebPro. All rights reserved.</p>
    </div>
  </footer>

  <!-- AI Chatbot Widget -->
  <div id="ai-chatbot-widget"></div>
  
  <!-- JAVASCRIPT -->
  <!-- Flatpickr (Calendar) JS -->
  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
  
  <!-- PayPal SDK - We will load this dynamically in purchase.js -->
  <!-- We need main.js for the chatbot and auth state -->
  <script src="/js/main.js"></script>
  <!-- We need purchase.js for the flow logic -->
  <script src="/js/purchase.js"></script>

</body>
</html>
